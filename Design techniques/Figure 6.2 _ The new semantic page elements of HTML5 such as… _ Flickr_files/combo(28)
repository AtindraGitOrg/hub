YUI.add("hermes-template-slideshow",function(a,n){var e=a.Template.Handlebars.revive({1:function(a,n,e,l,r){return" no-click"},3:function(a,n,e,l,r){return" is-hidden"},5:function(a,n,e,l,r){return" is-video"},7:function(a,n,e,l,r){var t;return a.escapeExpression("function"==typeof(t=null!=(t=e["prev-url"]||(null!=n?n["prev-url"]:n))?t:e.helperMissing)?t.call(null!=n?n:{},{name:"prev-url",hash:{},data:r}):t)},9:function(a,n,e,l,r){return"#"},11:function(a,n,e,l,r){var t;return a.escapeExpression("function"==typeof(t=null!=(t=e["next-url"]||(null!=n?n["next-url"]:n))?t:e.helperMissing)?t.call(null!=n?n:{},{name:"next-url",hash:{},data:r}):t)},compiler:[7,">= 4.0.0"],main:function(a,n,e,l,r){var t,s=null!=n?n:{},i=e.helperMissing,o=a.escapeExpression;return o((e.outlet||n&&n.outlet||i).call(s,null!=n?n["photo-well-view"]:n,{name:"outlet",hash:{},data:r}))+'\n<a class="playpause chrome" data-track="playpauseClick"><span class="pause-button"></span><span class="play-button"></span><div class="timer"></div></a>\n\n<a class="navigate-target chrome navigate-prev'+(null!=(t=e.if.call(s,null!=n?n["prev-is-not-clickable"]:n,{name:"if",hash:{},fn:a.program(1,r,0),inverse:a.noop,data:r}))?t:"")+(null!=(t=e.if.call(s,null!=n?n["is-hidden"]:n,{name:"if",hash:{},fn:a.program(3,r,0),inverse:a.noop,data:r}))?t:"")+(null!=(t=e.if.call(s,null!=n?n["is-video"]:n,{name:"if",hash:{},fn:a.program(5,r,0),inverse:a.noop,data:r}))?t:"")+'" href="'+(null!=(t=e.if.call(s,null!=n?n["prev-url"]:n,{name:"if",hash:{},fn:a.program(7,r,0),inverse:a.program(9,r,0),data:r}))?t:"")+'" data-track="prevPhotoButtonClick" data-direction="prev"><span class="navigate-target-arrow"></span></a>\n\n<a class="navigate-target chrome navigate-next'+(null!=(t=e.if.call(s,null!=n?n["next-is-not-clickable"]:n,{name:"if",hash:{},fn:a.program(1,r,0),inverse:a.noop,data:r}))?t:"")+(null!=(t=e.if.call(s,null!=n?n["is-hidden"]:n,{name:"if",hash:{},fn:a.program(3,r,0),inverse:a.noop,data:r}))?t:"")+(null!=(t=e.if.call(s,null!=n?n["is-video"]:n,{name:"if",hash:{},fn:a.program(5,r,0),inverse:a.noop,data:r}))?t:"")+'" href="'+(null!=(t=e.if.call(s,null!=n?n["next-url"]:n,{name:"if",hash:{},fn:a.program(11,r,0),inverse:a.program(9,r,0),data:r}))?t:"")+'" data-track="nextPhotoButtonClick" data-direction="next"><span class="navigate-target-arrow"></span></a>\n\n<a class="close chrome" data-track="closeClick"><span></span></a>\n'+o((e.outlet||n&&n.outlet||i).call(s,null!=n?n["slideshow-attribution-view"]:n,{name:"outlet",hash:{},data:r}))+"\n"},useData:!0}),l={};a.Array.each([],function(n){var e=a.Template.get("hermes/"+n);e&&(l[n]=e)}),a.Template.register("hermes/slideshow",function(n,r){return r=r||{},r.partials=r.partials?a.merge(l,r.partials):l,e(n,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-pro-badge",function(n,a){var e=n.Template.Handlebars.revive({1:function(n,a,e,l,r){var s;return null!=(s=(e.ifCond||a&&a.ifCond||e.helperMissing).call(null!=a?a:{},null!=a?a.badgeType:a,"===","legacy",{name:"ifCond",hash:{},fn:n.program(2,r,0),inverse:n.program(15,r,0),data:r}))?s:""},2:function(n,a,e,l,r){var s,i=null!=a?a:{};return"\t\t<a "+(null!=(s=e.if.call(i,null!=a?a.noLink:a,{name:"if",hash:{},fn:n.noop,inverse:n.program(3,r,0),data:r}))?s:"")+' class="pro-badge-new pro-badge-legacy'+(null!=(s=e.if.call(i,null!=a?a.noLink:a,{name:"if",hash:{},fn:n.program(5,r,0),inverse:n.noop,data:r}))?s:"")+(null!=(s=e.if.call(i,null!=a?a.light:a,{name:"if",hash:{},fn:n.program(7,r,0),inverse:n.noop,data:r}))?s:"")+(null!=(s=e.if.call(i,null!=a?a.extraClasses:a,{name:"if",hash:{},fn:n.program(9,r,0),inverse:n.noop,data:r}))?s:"")+'" title="'+n.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(i,{name:"intlMessage",hash:{intlName:"common.FLICKR_LOVES_OLD_SCHOOL_PROS"},data:r}))+'">\n'+(null!=(s=e.if.call(i,null!=a?a.light:a,{name:"if",hash:{},fn:n.program(11,r,0),inverse:n.program(13,r,0),data:r}))?s:"")+"\t\t</a>\n"},3:function(n,a,e,l,r){return'href="/account/upgrade/pro"'},5:function(n,a,e,l,r){return" no-link"},7:function(n,a,e,l,r){return" light"},9:function(n,a,e,l,r){var s;return" "+n.escapeExpression("function"==typeof(s=null!=(s=e.extraClasses||(null!=a?a.extraClasses:a))?s:e.helperMissing)?s.call(null!=a?a:{},{name:"extraClasses",hash:{},data:r}):s)},11:function(n,a,e,l,r){return'\t\t\t\t<svg class="icon icon-old-pro-badge"><use xlink:href="#icon-old-pro-badge-colorless"></use></svg>\n'},13:function(n,a,e,l,r){return'\t\t\t\t<svg class="icon icon-old-pro-badge-color"><use xlink:href="#icon-old-pro-badge"></use></svg>\n'},15:function(n,a,e,l,r){var s,i=null!=a?a:{};return"\t\t<a "+(null!=(s=e.if.call(i,null!=a?a.noLink:a,{name:"if",hash:{},fn:n.noop,inverse:n.program(3,r,0),data:r}))?s:"")+' class="pro-badge-new'+(null!=(s=e.if.call(i,null!=a?a.noLink:a,{name:"if",hash:{},fn:n.program(5,r,0),inverse:n.noop,data:r}))?s:"")+(null!=(s=e.if.call(i,null!=a?a.light:a,{name:"if",hash:{},fn:n.program(7,r,0),inverse:n.noop,data:r}))?s:"")+(null!=(s=e.if.call(i,null!=a?a.extraClasses:a,{name:"if",hash:{},fn:n.program(9,r,0),inverse:n.noop,data:r}))?s:"")+'">\n\t\t\t<svg class="icon icon-pro-badge"><use xlink:href="#icon-pro-badge"></use></svg>\n\t\t</a>\n'},17:function(n,a,e,l,r){var s;return'\t<a href="/account/upgrade/pro" class="pro-badge-inline'+(null!=(s=e.if.call(null!=a?a:{},null!=a?a.extraClasses:a,{name:"if",hash:{},fn:n.program(9,r,0),inverse:n.noop,data:r}))?s:"")+'">PRO</a>\n'},compiler:[7,">= 4.0.0"],main:function(n,a,e,l,r){var s;return null!=(s=(e.isFlipped||a&&a.isFlipped||e.helperMissing).call(null!=a?a:{},"enable-pro-badge-toggle",{name:"isFlipped",hash:{},fn:n.program(1,r,0),inverse:n.program(17,r,0),data:r}))?s:""},useData:!0}),l={};n.Array.each([],function(a){var e=n.Template.get("hermes/"+a);e&&(l[a]=e)}),n.Template.register("hermes/pro-badge",function(a,r){return r=r||{},r.partials=r.partials?n.merge(l,r.partials):l,e(a,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-attribution",function(a,n){var e=a.Template.Handlebars.revive({1:function(a,n,e,l,t){var i,s=null!=n?n:{},r=e.helperMissing,o=a.escapeExpression;return'\t<a class="avatar person medium no-menu" data-person-nsid="'+o("function"==typeof(i=null!=(i=e.nsid||(null!=n?n.nsid:n))?i:r)?i.call(s,{name:"nsid",hash:{},data:t}):i)+'" style="background-image: url('+o("function"==typeof(i=null!=(i=e.buddyicon||(null!=n?n.buddyicon:n))?i:r)?i.call(s,{name:"buddyicon",hash:{},data:t}):i)+');" href="/photos/'+o("function"==typeof(i=null!=(i=e.pathAlias||(null!=n?n.pathAlias:n))?i:r)?i.call(s,{name:"pathAlias",hash:{},data:t}):i)+'/"></a>\n'},3:function(a,n,e,l,t){var i,s=null!=n?n:{},r=e.helperMissing,o=a.escapeExpression;return'\t<div class="avatar person medium" data-person-nsid="'+o("function"==typeof(i=null!=(i=e.nsid||(null!=n?n.nsid:n))?i:r)?i.call(s,{name:"nsid",hash:{},data:t}):i)+'" style="background-image: url('+o("function"==typeof(i=null!=(i=e.buddyicon||(null!=n?n.buddyicon:n))?i:r)?i.call(s,{name:"buddyicon",hash:{},data:t}):i)+');" tabindex="0"></div>\n'},5:function(a,n,e,l,t){var i;return null!=(i=e.if.call(null!=n?n:{},null!=n?n.isPro:n,{name:"if",hash:{},fn:a.program(6,t,0),inverse:a.noop,data:t}))?i:""},6:function(a,n,e,l,t){var i;return null!=(i=e.if.call(null!=n?n:{},null!=n?n.realFullscreenEnabled:n,{name:"if",hash:{},fn:a.program(7,t,0),inverse:a.program(9,t,0),data:t}))?i:""},7:function(a,n,e,l,t){var i;return null!=(i=a.invokePartial(l["pro-badge"],n,{name:"pro-badge",hash:{light:!0,badgeType:null!=n?n.proBadge:n},data:t,indent:"\t\t\t",helpers:e,partials:l,decorators:a.decorators}))?i:""},9:function(a,n,e,l,t){var i;return null!=(i=a.invokePartial(l["pro-badge"],n,{name:"pro-badge",hash:{badgeType:null!=n?n.proBadge:n},data:t,indent:"\t\t\t",helpers:e,partials:l,decorators:a.decorators}))?i:""},11:function(a,n,e,l,t){var i;return null!=(i=e.if.call(null!=n?n:{},null!=n?n.isPro:n,{name:"if",hash:{},fn:a.program(7,t,0),inverse:a.noop,data:t}))?i:""},compiler:[7,">= 4.0.0"],main:function(a,n,e,l,t){var i,s,r=null!=n?n:{},o=e.helperMissing,u=a.escapeExpression;return(null!=(i=e.if.call(r,null!=n?n.noMenu:n,{name:"if",hash:{},fn:a.program(1,t,0),inverse:a.program(3,t,0),data:t}))?i:"")+"\n"+(null!=(i=e.unless.call(r,null!=n?n.isAlbumView:n,{name:"unless",hash:{},fn:a.program(5,t,0),inverse:a.noop,data:t}))?i:"")+'\n<div class="attribution-info">\n\n\t<a href="/photos/'+u("function"==typeof(s=null!=(s=e.pathAlias||(null!=n?n.pathAlias:n))?s:o)?s.call(r,{name:"pathAlias",hash:{},data:t}):s)+'/" class="owner-name truncate" title="'+u((e.intlMessage||n&&n.intlMessage||o).call(r,{name:"intlMessage",hash:{name:null!=n?n.displayname:n,intlName:"attribution.GO_TO_PHOTOSTREAM"},data:t}))+'" data-track="attributionNameClick">'+u("function"==typeof(s=null!=(s=e.displayname||(null!=n?n.displayname:n))?s:o)?s.call(r,{name:"displayname",hash:{},data:t}):s)+'</a>\n\t<a href="/photos/'+u("function"==typeof(s=null!=(s=e.pathAlias||(null!=n?n.pathAlias:n))?s:o)?s.call(r,{name:"pathAlias",hash:{},data:t}):s)+'/" class="owner-name-with-by truncate" title="'+u((e.intlMessage||n&&n.intlMessage||o).call(r,{name:"intlMessage",hash:{name:null!=n?n.displayname:n,intlName:"attribution.GO_TO_PHOTOSTREAM"},data:t}))+'" data-track="attributionNameClick">'+u((e.intlMessage||n&&n.intlMessage||o).call(r,{name:"intlMessage",hash:{user:null!=n?n.displayname:n,intlName:"attribution.BY_USER"},data:t}))+"</a>\n\n\t"+u((e.outlet||n&&n.outlet||o).call(r,null!=n?n["follow-view"]:n,{name:"outlet",hash:{},data:t}))+"\n\n"+(null!=(i=e.if.call(r,null!=n?n.isAlbumView:n,{name:"if",hash:{},fn:a.program(11,t,0),inverse:a.noop,data:t}))?i:"")+"\n</div>\n"},usePartial:!0,useData:!0}),l={};a.Array.each(["pro-badge","pro-badge","pro-badge"],function(n){var e=a.Template.get("hermes/"+n);e&&(l[n]=e)}),a.Template.register("hermes/attribution",function(n,t){return t=t||{},t.partials=t.partials?a.merge(l,t.partials):l,e(n,t)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-pro-badge","hermes-template-pro-badge","hermes-template-pro-badge"]});YUI.add("slideshow-attribution-view",function(e,i){var n=require("hermes-core/flog")(i);e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(e){this.set("isActiveViewAgnostic",e.isActiveViewAgnostic);var i=e.collection.getList()[e.position];return i&&(this.nsid=e.nsid=i.getValue("owner").getValue("nsid")),this.realFullscreen=!0,this},langBundles:this.details.langBundles,subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,isActiveViewAgnostic:!0,isFluid:!0,isOnDark:!0}},loadState:function(){var e=this;if(this.nsid)return this.appContext.getModel("person-models",this.nsid).then(function(i){e.set("owner",i)});throw new Error("missing nsid")},buildContainer:function(){var e,i=this.get("owner"),n=this.appContext.getViewer().nsid,t=i.getValue("pathAlias")||i.getValue("nsid");return e=i.getValue("buddyicon").large?i.getValue("buddyicon").large:i.getValue("buddyicon").default,this.setContainerWithTemplate("attribution",{pathAlias:t,buddyicon:e,nsid:i.getValue("nsid"),noMenu:!0,displayname:i.getValue("displayname"),follow:this.subviews["follow-view"]?this.subviews["follow-view"].get("container"):"",realFullscreenEnabled:this.realFullscreen&&this.appContext.experiments.fullscreen.getMode()}),n===i.getValue("nsid")&&this.get("container").addClass("is-self"),this},activate:function(){return this.registerEventHandler(e.on("personMenuOpen",this.handlePersonMenuOpen.bind(this))),this.registerEventHandler(e.on("personMenuClose",this.handlePersonMenuClose.bind(this))),this},handlePersonMenuOpen:function(e){this.fire("subviewViewEvent","personMenuOpen")},handlePersonMenuClose:function(e){this.fire("subviewViewEvent","personMenuClose")},onParentViewEvent:function(e,i){var t,s,o=this;i&&i[0]&&("slideshowView:newPhoto"===(t=i[0])?i[1]&&(s=i[1].getValue("owner").getValue("nsid"))!==this.nsid&&(this.nsid=s,this.set("owner",i[1].getValue("owner")),this.subviews["follow-view"]&&this.subviews["follow-view"].destroy({remove:!0}),this.instantiateSubview("follow-view",{nsid:s,realFullscreen:!0,isActiveViewAgnostic:!0,isFluid:!0,isOnDark:!0}).then(function(e){return e.initialize()}).then(function(e){o.buildContainer(),o.get("container").one(".follow-view").addClass("is-real-fullscreen photo-attribution"),e.normalizedActivate()}).catch(function(e){n.error("Error loading follow-view",{err:e})})):"slideshowView:preloadPhoto"===t&&(s=i[1].getValue("owner").getValue("nsid"))!==this.nsid&&o.appContext.getModel("person-relationship-models",{id:s}))}})},"@VERSION@",{requires:["flickr-view","hermes-template-attribution"],optional:["person-models"],langBundles:["attribution"]});YUI.add("hermes-lang-attribution",function(e,r){e.Intl.add("hermes/attribution","en-US",{FOLLOW:["Follow"],FOLLOWING:["Following"],ERROR_SETTING_FRIEND:["There was a problem setting your friend relationship"],ERROR_SETTING_FAMILY:["There was a ",{type:"number",valueName:"POPULATION",format:"integer"}," problem setting your family relationship"],FRIEND:["Friend"],FAMILY:["Family"],UNFOLLOW:["Unfollow"],GO_TO_PHOTOSTREAM:["Go to ","${name}","'s photostream"],BY_USER:["By: ","${user}"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-photo-well-media-scrappy",function(t,a){var e=t.Template.Handlebars.revive({1:function(t,a,e,l,n){var i,s=null!=a?a:{};return'\t<div class="restricted-interstitial">\n\t\t<div class="restricted-interstitial-message">\n\t\t\t<h2>'+t.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADULT_CONTENT"},data:n}))+"</h2>\n"+(null!=(i=e.if.call(s,null!=a?a.isSignedIn:a,{name:"if",hash:{},fn:t.program(2,n,0),inverse:t.program(5,n,0),data:n}))?i:"")+"\t\t</div>\n\t</div>\n"},2:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r=t.escapeExpression;return"\t\t\t\t<p>"+r((e.intlMessage||a&&a.intlMessage||h).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.MATURE_AUDIENCES"},data:n}))+"<br />"+r((e.intlMessage||a&&a.intlMessage||h).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.USER_DISCRETION"},data:n}))+"</p>\n\n"+(null!=(i=e.unless.call(s,null!=a?a.isMinor:a,{name:"unless",hash:{},fn:t.program(3,n,0),inverse:t.noop,data:n}))?i:"")},3:function(t,a,e,l,n){var i=null!=a?a:{},s=e.helperMissing,h=t.escapeExpression;return"\t\t\t\t\t<p><button class='ui-button'><span>"+h((e.intlMessage||a&&a.intlMessage||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_ME_THIS_CONTENT_TYPE"},data:n}))+"</span></button></p>\n\t\t\t\t\t<p>"+h((e.intlHTMLMessage||a&&a.intlHTMLMessage||s).call(i,{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.CHANGE_SAFE_SEARCH_IN_SETTINGS"},data:n}))+"</p>\n"},5:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r=t.escapeExpression;return"\t\t\t\t<p>"+r((e.intlMessage||a&&a.intlMessage||h).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SIGNED_IN_FOR_CONTENT"},data:n}))+' <a href="//'+r("function"==typeof(i=null!=(i=e.host||(null!=a?a.host:a))?i:h)?i.call(s,{name:"host",hash:{},data:n}):i)+'/signin/" data-track="photoWellSignInClick">'+r((e.intlMessage||a&&a.intlMessage||h).call(s,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:n}))+"</a></p>\n"},7:function(t,a,e,l,n){var i;return null!=(i=e.if.call(null!=a?a:{},null!=a?a.isVideo:a,{name:"if",hash:{},fn:t.program(8,n,0),inverse:t.program(10,n,0),data:n}))?i:""},8:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r=t.escapeExpression;return'\t\t<div class="videoplayer main-photo" style="width:'+r("function"==typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)?i.call(s,{name:"width",hash:{},data:n}):i)+"px; height:"+r("function"==typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)?i.call(s,{name:"height",hash:{},data:n}):i)+'px;"><video id="video_1" poster="'+r("function"==typeof(i=null!=(i=e.src||(null!=a?a.src:a))?i:h)?i.call(s,{name:"src",hash:{},data:n}):i)+'" class="video-js vjs-big-play-centered inherit-size"></video></div>\n'},10:function(t,a,e,l,n){var i;return null!=(i=e.if.call(null!=a?a:{},null!=a?a.showFuzzy:a,{name:"if",hash:{},fn:t.program(11,n,0),inverse:t.program(13,n,0),data:n}))?i:""},11:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r=t.escapeExpression;return'\t\t\t<span class="restricted-image main-photo" style="width:'+r("function"==typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)?i.call(s,{name:"width",hash:{},data:n}):i)+"px;height:"+r("function"==typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)?i.call(s,{name:"height",hash:{},data:n}):i)+'px;"></span>\n'},13:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r="function",o=t.escapeExpression;return'\t\t\t<span class="facade-of-protection-neue" style="width:'+o(typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)===r?i.call(s,{name:"width",hash:{},data:n}):i)+"px;height:"+o(typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)===r?i.call(s,{name:"height",hash:{},data:n}):i)+'px;">\n\t\t\t\t'+o((e.outlet||a&&a.outlet||h).call(s,null!=a?a["zoom-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\t\t\t\t"+o((e.outlet||a&&a.outlet||h).call(s,null!=a?a["vr-overlay-view"]:a,{name:"outlet",hash:{},data:n}))+'\n\t\t\t</span>\n\n\t\t\t<img width="'+o(typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)===r?i.call(s,{name:"width",hash:{},data:n}):i)+'" height="'+o(typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)===r?i.call(s,{name:"height",hash:{},data:n}):i)+'" src="'+o(typeof(i=null!=(i=e.src||(null!=a?a.src:a))?i:h)===r?i.call(s,{name:"src",hash:{},data:n}):i)+'" class="low-res-photo" alt="'+o(typeof(i=null!=(i=e.imgAltText||(null!=a?a.imgAltText:a))?i:h)===r?i.call(s,{name:"imgAltText",hash:{},data:n}):i)+'">\n\t\t\t<img width="'+o(typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)===r?i.call(s,{name:"width",hash:{},data:n}):i)+'" height="'+o(typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)===r?i.call(s,{name:"height",hash:{},data:n}):i)+'" src="'+o(typeof(i=null!=(i=e.highResSrc||(null!=a?a.highResSrc:a))?i:h)===r?i.call(s,{name:"highResSrc",hash:{},data:n}):i)+'" class="main-photo is-hidden" alt="'+o(typeof(i=null!=(i=e.imgAltText||(null!=a?a.imgAltText:a))?i:h)===r?i.call(s,{name:"imgAltText",hash:{},data:n}):i)+'">\n\t\t\t<script nonce="'+o(typeof(i=null!=(i=e.cspNonce||(null!=a?a.cspNonce:a))?i:h)===r?i.call(s,{name:"cspNonce",hash:{},data:n}):i)+"\">\n\t\t\t\tvar img = document.querySelector('.photo-well-media-scrappy-view img.main-photo');\n\t\t\t\timg.onload = function () { registerFirstPhoto(img); };\n\t\t\t<\/script>\n\t\t\t<noscript>\n\t\t\t\t<img width=\""+o(typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)===r?i.call(s,{name:"width",hash:{},data:n}):i)+'" height="'+o(typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)===r?i.call(s,{name:"height",hash:{},data:n}):i)+'" src="'+o(typeof(i=null!=(i=e.highResSrc||(null!=a?a.highResSrc:a))?i:h)===r?i.call(s,{name:"highResSrc",hash:{},data:n}):i)+'" class="main-photo" alt="'+o(typeof(i=null!=(i=e.imgAltText||(null!=a?a.imgAltText:a))?i:h)===r?i.call(s,{name:"imgAltText",hash:{},data:n}):i)+'">\n\t\t\t</noscript>\n'},compiler:[7,">= 4.0.0"],main:function(t,a,e,l,n){var i;return null!=(i=e.if.call(null!=a?a:{},null!=a?a.needsInterstitial:a,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.program(7,n,0),data:n}))?i:""},useData:!0}),l={};t.Array.each([],function(a){var e=t.Template.get("hermes/"+a);e&&(l[a]=e)}),t.Template.register("hermes/photo-well-media-scrappy",function(a,n){return n=n||{},n.partials=n.partials?t.merge(l,n.partials):l,e(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("slideshow-well-view",function(e,t){var i=require("hermes-core/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){var t=e.collection.getList()[e.position];if(!t)throw new Error("missing photo");return this.set("photo",t),this.set("isActiveViewAgnostic",!0),this.set("canvasSizeIsDirty",!0),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},buildContainer:function(){var e,t,o=this,n=this.get("photo");return o.preloadImage&&(o.preloadImage.onload=null),this.appContext.forceServerRender?t=e=this.getPhotoForDisplay(n,{canvas:{width:Number.MAX_VALUE,height:Number.MAX_VALUE}}):(e=this.getPhotoForDisplay(n),t=this.getPhotoForDisplay(n,{includeSizes:["sq","q","t","s","n"]})),this.setContainerWithTemplate("photo-well-media-scrappy",{width:e.width,height:e.height,src:t.url,highResSrc:e.url,showFuzzy:n.getValue("needsInterstitial"),isSignedIn:this.appContext.getViewer().signedIn,isVideo:!1}),YUI.Env.isServer?(this.serverWidth=e.width,this.serverHeight=e.height):n.getValue("needsInterstitial")||this.preloadPhoto(n).then(function(){var e=o.get("container").one(".low-res-photo"),t=o.get("container").one(".main-photo");t&&t.removeClass("is-hidden").show(),e&&e.hide()}).catch(function(e){i.error("Error building slideshow",{err:e})}),this},preloadPhoto:function(t){var i=this;return new e.Promise(function(e,o){return i.generatePhotoElement(t,e,o)})},generateFuzzyElement:function(e){var t,i;return t=this.getPhotoForDisplay(e),i=document.createElement("span"),i.style.width=t.width+"px",i.style.height=t.height+"px",i},generatePhotoElement:function(t,i,o){var n,r;return n=this.getPhotoForDisplay(t),r=new Image,r.src=n.url,r.width=n.width,r.height=n.height,r.complete&&i&&"function"==typeof i&&i(t),r=e.one(r),i&&"function"==typeof i&&r.once("load",function(){i(t),r.detachAll(),r=void 0}),o&&"function"==typeof o&&r.once("error",function(){o(t),r.detachAll(),r=void 0}),r},handlePhotoLoaded:function(e){this.fire("subviewViewEvent","photoLoaded"),e.getValue("isOwner")||this.appContext.getViewCounter().queue(e.getValue("id"),this.appContext.getReferrer())},swapPhoto:function(t,i){var o,n,r;(r=this.get("container").one(".restricted-image"))&&(n=!0),t.getValue("needsInterstitial")?((o=this.generateFuzzyElement(t)).className="main-photo outro restricted-image",o=e.one(o),r=this.get("container").one(".main-photo"),i||(r.once("transitionend",function(){r.detach(),r&&r.remove(!0),r=void 0}),r.removeClass("main-photo"),r.removeClass("intro"),r.addClass("outro"),o.removeClass("outro"),o.addClass("intro")),r.insert(o,"before"),i&&(o.removeClass("outro"),r.remove(!0)),this.fire("subviewViewEvent","photoLoaded")):(o=this.generatePhotoElement(t,this.handlePhotoLoaded.bind(this)),n||(r=this.get("container").one(".main-photo")),o.addClass("main-photo"),o.addClass("outro"),r&&r.removeClass("main-photo"),i?(o&&o.removeClass("outro"),r&&(r.insert(o,"before"),r.remove(!0))):(r&&(r.once("transitionend",function(){r.detachAll(),r&&r.remove(!0),r=void 0}),r.addClass("outro"),r.removeClass("intro"),r.insert(o,"before")),o&&(o.removeClass("outro"),o.addClass("intro"))))},onParentViewEvent:function(e,t){if(t&&t[0])switch(t[0]){case"photoWellResized":this.get("photo").getValue("needsInterstitial")||this.buildContainer();break;case"slideshowView:newPhoto":t[1]&&(this.set("photo",t[1]),this.swapPhoto(t[1],t[2]));break;case"slideshowView:preloadPhoto":t[1]&&this.preloadPhoto(t[1])}},activate:function(){var t=this;return this.get("photo").getValue("needsInterstitial")||(this.registerEventHandler(e.on("flickr:photo-media-well-update",function(e){t.buildContainer()})),e.use("global-events",function(e){t.registerEventHandler(e.globalEvents.subscribe("window:resize",function(e){t.buildContainer()}))})),this.appContext.getViewer().signedIn&&this.appContext.getModel("person-preferences-models",t.appContext.auth.user.nsid).then(function(e){t.set("personPreferences",e),t.get("photo").getValue("needsInterstitial")&&!this.appContext.getViewer().isMinor&&t.registerEventHandler(t.get("container").one(".restricted-interstitial-message button").on("click",t.handleInterstitialDismissButtonClick,t))}),this},getPhotoForDisplay:function(e,t){var i,o,n,r=this.getCanvasSize(),s=this.getPixelRatio();return t&&t.canvasSize&&(r=t.canvasSize),i=e.getSizeToFit(r,t),o=r.height/s,n=Math.min(r.width/s,i.width/i.height*o),o=Math.min(o,i.height/i.width*n),{width:Math.round(n),height:Math.round(o),url:i.url,pixelRatio:i.width/n}},getCanvasSize:function(){var t,i,o=this.getPixelRatio(),n={width:500,height:500};return this.get("canvasSizeIsDirty")?YUI.Env.isServer||(i=e.one("#content"))&&((t=i.get("region")).height=e.config.win.innerHeight,t.width=e.config.win.innerWidth):t=this.get("cachedCanvasSize"),this.appContext.viewportData.viewport.width>0&&(n={width:this.appContext.viewportData.viewport.width,height:this.appContext.viewportData.viewport.height-240}),t||(t={top:0,left:0,bottom:500,right:500,width:n.width,height:n.height}),t.height*=o,t.width*=o,t},getPixelRatio:function(){return this.appContext.getViewer().getPixelRatio()}},{})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-well-media-scrappy"],langBundles:["common","photo-page-scrappy"]});