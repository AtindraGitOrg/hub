YUI.add("hermes-template-bulk-download-modal",function(n,a){var e=n.Template.Handlebars.revive({1:function(n,a,e,l,t){var s,r=null!=a?a:{};return"\t<p>"+(null!=(s=e.if.call(r,null!=a?a.loggedOut:a,{name:"if",hash:{},fn:n.program(2,t,0),inverse:n.program(4,t,0),data:t}))?s:"")+'</p>\n\n\t<p class="copyright">'+(null!=(s=e.unless.call(r,null!=a?a.isOwnAlbum:a,{name:"unless",hash:{},fn:n.program(6,t,0),inverse:n.noop,data:t}))?s:"")+"</p>\n\n"},2:function(n,a,e,l,t){return n.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"downloadr.DOWNLOAD_WHEN_READY_LOGGED_OUT"},data:t}))},4:function(n,a,e,l,t){return n.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"downloadr.DOWNLOAD_WHEN_READY"},data:t}))},6:function(n,a,e,l,t){return n.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"downloadr.BE_SURE_RIGHTS"},data:t}))},8:function(n,a,e,l,t){var s,r=null!=a?a:{};return"\n"+(null!=(s=e.unless.call(r,null!=a?a.isOwnAlbum:a,{name:"unless",hash:{},fn:n.program(9,t,0),inverse:n.noop,data:t}))?s:"")+"\n"+(null!=(s=e.if.call(r,null!=a?a.isMany:a,{name:"if",hash:{},fn:n.program(11,t,0),inverse:n.noop,data:t}))?s:"")+"\n"+(null!=(s=e.if.call(r,null!=a?a.isMany:a,{name:"if",hash:{},fn:n.program(13,t,0),inverse:n.program(16,t,0),data:t}))?s:"")},9:function(n,a,e,l,t){return"\t\t<p>"+n.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"album-page.DOWNLOAD_ALBUM_LICENSE_MESSAGE_ALT_2"},data:t}))+"</p>\n"},11:function(n,a,e,l,t){return"\t\t<p>"+n.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"album-page.ALOT_OF_PHOTOS"},data:t}))+"</p>\n"},13:function(n,a,e,l,t){var s;return"\t\t<ul>\n"+(null!=(s=e.each.call(null!=a?a:{},null!=a?a.downloadURLs:a,{name:"each",hash:{},fn:n.program(14,t,0),inverse:n.noop,data:t}))?s:"")+"\t\t</ul>\n"},14:function(n,a,e,l,t){var s,r=null!=a?a:{},i=e.helperMissing,u=n.escapeExpression;return"\t\t\t\t<li>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t"+u((e.intlMessage||a&&a.intlMessage||i).call(r,{name:"intlMessage",hash:{partSequence:null!=a?a.partSequence:a,intlName:"album-page.DOWNLOAD_ZIP_PART"},data:t}))+'\n\t\t\t\t\t</span>\n\t\t\t\t\t<a class="butt mini" href="'+u("function"==typeof(s=null!=(s=e.url||(null!=a?a.url:a))?s:i)?s.call(r,{name:"url",hash:{},data:t}):s)+'">'+u((e.intlMessage||a&&a.intlMessage||i).call(r,{name:"intlMessage",hash:{intlName:"common.DOWNLOAD"},data:t}))+"</a>\n\t\t\t\t</li>\n"},16:function(n,a,e,l,t){var s,r,i=n.escapeExpression;return'\t\t<a class="butt mini" href="'+i(n.lambda(null!=(s=null!=(s=null!=a?a.downloadURLs:a)?s[0]:s)?s.url:s,a))+'">'+i("function"==typeof(r=null!=(r=e.buttonLabel||(null!=a?a.buttonLabel:a))?r:e.helperMissing)?r.call(null!=a?a:{},{name:"buttonLabel",hash:{},data:t}):r)+"</a>\n"},compiler:[7,">= 4.0.0"],main:function(n,a,e,l,t){var s;return null!=(s=e.if.call(null!=a?a:{},null!=a?a.doOffline:a,{name:"if",hash:{},fn:n.program(1,t,0),inverse:n.program(8,t,0),data:t}))?s:""},useData:!0}),l={};n.Array.each([],function(a){var e=n.Template.get("hermes/"+a);e&&(l[a]=e)}),n.Template.register("hermes/bulk-download-modal",function(a,t){return t=t||{},t.partials=t.partials?n.merge(l,t.partials):l,e(a,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-download-tooltip",function(n,e){var a=n.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(n,e,a,t,l){var r,i=null!=e?e:{},o=a.helperMissing,s=n.escapeExpression;return"<div>\n\t"+s("function"==typeof(r=null!=(r=a.content||(null!=e?e.content:e))?r:o)?r.call(i,{name:"content",hash:{},data:l}):r)+'\n\t<br/>\n\t<br/>\n\t<a class="close-onboarding">'+s("function"==typeof(r=null!=(r=a.confirmationLink||(null!=e?e.confirmationLink:e))?r:o)?r.call(i,{name:"confirmationLink",hash:{},data:l}):r)+"</a>\n</div>\n"},useData:!0}),t={};n.Array.each([],function(e){var a=n.Template.get("hermes/"+e);a&&(t[e]=a)}),n.Template.register("hermes/download-tooltip",function(e,l){return l=l||{},l.partials=l.partials?n.merge(t,l.partials):t,a(e,l)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("bulk-downloader-view",function(e,t){"use strict";e.BulkDownloaderView=e.Base.create("BulkDownloaderView",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.localizeLib=e.mix({langBundles:["common","album-page","cameraroll"],appContext:this.appContext},e.Localizable),this.set("isOwnAlbum",t.isOwnAlbum),this.doOffline=!!t.doOffline},showLoadingDialog:function(){return new e.Views.FluidModal({appContext:this.appContext,showCancelButton:!1,showFooter:!1,showActionButton:!1,title:this.intlMessage({intlName:"cameraroll.PREPARING_DOWNLOAD"}),message:this.templates("flickr-balls")({}),classList:"bulk-download-loading-dialog"}).show()},createTitle:function(e,t){var o="";if(e=e||0,t=t||0,e>0&&t>0)o=this.intlMessage({intlName:"album-page.DOWNLOAD_PHOTOS_AND_VIDEO",photoCount:e,videoCount:t});else if(e>0&&0===t)o=this.intlMessage({intlName:"album-page.DOWNLOAD_PHOTOS",photoCount:e});else{if(!(0===e&&t>0))throw new Error(this.intlMessage({intlName:"cameraroll.DOWNLOAD_NOT_AVAILABLE_ERROR"}));o=this.intlMessage({intlName:"album-page.DOWNLOAD_VIDEOS",videoCount:t})}return o},createButtonLabel:function(e,t){var o="";return t+e>1?o=this.intlMessage({intlName:"album-page.DOWNLOAD_ZIP"}):1===e&&0===t?o=this.intlMessage({intlName:"album-page.DOWNLOAD_PHOTOS",photoCount:e}):0===e&&1===t&&(o=this.intlMessage({intlName:"album-page.DOWNLOAD_VIDEOS",videoCount:t})),o},prepareArchive:function(e){var t=this;return this.appContext.callAPI("flickr.download.archives.create",e).then(function(e){var o,n,i=e.archive.countPhotos,a=e.archive.countVideos,l=[],s=e.archive.key;return o=t.createTitle(i,a),n=t.createButtonLabel(i,a),l=e.archive.urls.map(function(e,t){return{url:e,partSequence:t+1}}),{title:o,downloadURLs:l,buttonLabel:n,key:s}}).catch(function(e){throw 105===e.code?new Error(t.intlMessage({intlName:"cameraroll.DOWNLOAD_DISABLED_ERROR"})):new Error(t.intlMessage({intlName:"cameraroll.DOWNLOAD_GENERIC_ERROR"}))})},showDownloadDialog:function(o){var n,i,a=o.title,l=this,s=o.downloadURLs||[];return this.doOffline&&((n=o.setID?{set_id:o.setID}:o.share_code?{share_code:o.share_code,gp_code:o.gp_code,gp_owner:o.gp_owner}:{photo_ids:o.photoIDs,owner_id:o.ownerID}).extras="offline_enabled"),i=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!this.doOffline,showCancelButton:!!this.doOffline,showFooter:!!this.doOffline,showActionButton:!!this.doOffline,actionButtonLabel:this.doOffline?this.intlMessage({intlName:"downloadr.CREATE_ZIP"}):"",title:a,message:this.templates("bulk-download-modal")({isMany:s.length>1,downloadURLs:s,buttonLabel:o.buttonLabel,isOwnAlbum:this.get("isOwnAlbum"),doOffline:this.doOffline,loggedOut:!this.appContext.getViewer().signedIn}),classList:"bulk-download-dialog"}).show(),l.doOffline?(i.on("actionClick",function(o){o.preventDefault(),e.rapidTracker.beacon(t,"completeArchiveDownloadClick"),i.get("container").one(".copyright").setHTML(l.templates("flickr-balls")({})),l.prepareArchive(n).then(function(e){i.close(),l.appContext.getViewer().signedIn?l.showTooltip(e.key):l.appContext.flapp.navigate("/download/"+e.key)}).catch(function(t){105===t.code?l.onError(new Error(l.intlMessage({intlName:"cameraroll.DOWNLOAD_DISABLED_ERROR"})),i):(e.config.win.beaconError("[bulk-download] Error creating archive ",e.config.win.location.href,t),l.onError(new Error(l.intlMessage({intlName:"cameraroll.DOWNLOAD_GENERIC_ERROR"})),i))})}),i.on("cancelClick",function(o){o.preventDefault(),e.rapidTracker.beacon(t,"archiveCancelClick"),i.close()})):i.on("activated",function(){i.get("container").all(".butt").on("click",function(o){1===s.length?(e.rapidTracker.beacon(t,"completeArchiveDownloadClick"),i.close()):(e.rapidTracker.beacon(t,"partialArchiveDownloadClick"),o.target.addClass("is-disabled"))})}),i},onError:function(t,o){o&&o.close(),new e.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"common.ERROR"}),message:t.message,actionButtonLabel:this.intlMessage({intlName:"common.OK"}),showCancelButton:!1}).show()},showTooltip:function(t){var o=e.one(".global-nav-view").one(".notifications-menu-view"),n=this;if(o){this.tooltip=new e.Views.FluidDroparound({appContext:this.appContext,htmlMessage:this.templates("download-tooltip")({content:this.intlHTMLMessage({intlName:"downloadr.TOOLTIP_DOWNLOAD_LINK_MESSAGE",url:"/download/"+t}),confirmationLink:this.intlMessage({intlName:"downloadr.TOOLTIP_OK"})}),showDropArrow:!0,dismissOnOverlayClick:!0,observePageResize:!0,anchorElement:o,keyboardAnchorElement:o,minVerticalSpace:400,width:350,positionFixed:!0,preferLeft:!0,closeOnScroll:!0,anchorOffsetHorizontal:11,anchorOffsetVertical:0});var i=this.tooltip.get("container");n.registerEventHandler(i.delegate("click",function(e){e.preventDefault(),n.tooltip.close()},".close-onboarding")),this.tooltip.show()}}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-modal-view","hermes-template-bulk-download-modal","hermes-template-download-tooltip","hermes-template-flickr-balls"],langBundles:["common","downloadr","album-page","cameraroll"],optional:[],affinity:"client"});YUI.add("html-file-dragdrop",function(e){"use strict";var r="htmlFileDragDrop",o=r+"-drag-over",t=r+"-error",i=["image/png","image/jpeg"];e.HtmlFileDragDrop=function(r){e.config.win.File&&e.config.win.FileList&&e.config.win.FileReader&&r.dropZone&&(this.dropZone=e.one(r.dropZone),this.dropZone.on("dragover",this.handleDragOver.bind(this)),this.dropZone.on("dragleave",this.handleDragLeave.bind(this)),this.dropZone.on("drop",this.handleDrop.bind(this)))},e.HtmlFileDragDrop.prototype.reset=function(){this.dropZone.removeClass(t),this.dropZone.removeClass(o)},e.HtmlFileDragDrop.prototype.handleDragOver=function(e){e.halt(),this.reset(),this.dropZone.addClass(o)},e.HtmlFileDragDrop.prototype.handleDragLeave=function(e){e.halt(),this.reset()},e.HtmlFileDragDrop.prototype.showError=function(){this.dropZone.addClass(t)},e.HtmlFileDragDrop.prototype.handleDrop=function(e){var r;if(e.halt(),this.dropZone.removeClass(o),e._event.dataTransfer.files.length>1)return this.dropZone.addClass(t),void this.fire("drop",new Error("FILE_COUNT"));if((r=e._event.dataTransfer.files[0])&&r.name){if(i.indexOf(r.type)<0)return void this.fire("drop",new Error("FILE_TYPE"));this.fire("drop",r)}},e.augment(e.HtmlFileDragDrop,e.EventTarget,!0,null,{prefix:r})},"@VERSION@",{affinity:"",requires:["event-custom"],optional:[]});YUI.add("hermes-template-photo-selector",function(t,e){var a=t.Template.Handlebars.revive({1:function(t,e,a,s,n){return'\t\t<div class="photo-selector-search-list-yours">\n\t\t\t<div class="photo-selector-search-list">\n\t\t\t\t<div class="photo-selector-search-list-container">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n'},3:function(t,e,a,s,n){return'\t\t<div class="photo-selector-search-list-contacts">\n\t\t\t<div class="photo-selector-search-list">\n\t\t\t\t<div class="photo-selector-search-list-container">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n'},5:function(t,e,a,s,n){return'\t\t<div class="photo-selector-search-list-everyone">\n\t\t\t<div class="photo-selector-search-list">\n\t\t\t\t<div class="photo-selector-search-list-container">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n'},7:function(t,e,a,s,n){return'\t\t<div class="photo-selector-search-list-marketplace"\n\t\t\t<div class="photo-selector-search-list">\n\t\t\t\t<div class="photo-selector-search-list-container">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n'},9:function(t,e,a,s,n){var l;return'<div class="photo-selector-upload is-hiding">\n'+(null!=(l=a.if.call(null!=e?e:{},null!=e?e.canUpload:e,{name:"if",hash:{},fn:t.program(10,n,0),inverse:t.program(12,n,0),data:n}))?l:"")+"</div>\n"},10:function(t,e,a,s,n){var l=null!=e?e:{},i=a.helperMissing,o=t.escapeExpression;return'\t\t<p class="upload-error"></p>\n\t\t<div class="drop-zone">\n\t\t\t<div class="drop-zone-content">\n\t\t\t\t<div class="balls"></div>\n\t\t\t\t<input type="file" class="file-select" name="file-select" accept="image/jpeg, image/png" />\n\t\t\t\t<p><i class="upload-icon"></i>'+o((a.intlHTMLMessage||e&&e.intlHTMLMessage||i).call(l,{name:"intlHTMLMessage",hash:{intlName:"wallart.DRAG_DROP_TO_UPLOAD"},data:n}))+"</p>\n\t\t\t\t<p>"+o((a.intlHTMLMessage||e&&e.intlHTMLMessage||i).call(l,{name:"intlHTMLMessage",hash:{intlName:"wallart.PHOTOS_UPLOADED_AS_PRIVATE"},data:n}))+'</p>\n\t\t\t</div>\n\t\t</div>\n\t\t<ul class="preview"></ul>\n'},12:function(t,e,a,s,n){var l=null!=e?e:{},i=a.helperMissing,o=t.escapeExpression;return'\t\t<div class="cant-upload">\n\t\t\t<div class="cant-upload-message">\n\t\t\t\t<span>'+o((a.intlMessage||e&&e.intlMessage||i).call(l,{name:"intlMessage",hash:{limitCount:(a.friendlyNumber||e&&e.friendlyNumber||i).call(l,1e3,{name:"friendlyNumber",hash:{},data:n}),intlName:"upload-blocking.YOUVE_REACHED_UPLOAD_LIMIT"},data:n}))+'</span>\n\t\t\t\t<a href="/account/upgrade/pro/">'+o((a.intlMessage||e&&e.intlMessage||i).call(l,{name:"intlMessage",hash:{intlName:"common.GET_PRO"},data:n}))+"</a>\n\t\t\t</div>\n\t\t</div>\n"},14:function(t,e,a,s,n){return'<div class="group-photo-selector-photos-wrapper">\n\t<div class="group-photo-selector-photos photo-selector-photos">\n\t\t<div class="group-photo-selector-photos-container">\n\t\t</div>\n\t</div>\n</div>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,a,s,n){var l,i=null!=e?e:{};return'<div class="photo-selector-title-bar hidden">\n\t<div class="back-to-list">\n\t\t<div class="back-to-list-icon"><svg class="icon icon-back"><use xlink:href="#icon-back"></use></svg></div>\n\t\t<div class="back-to-list-text">'+t.escapeExpression((a.intlMessage||e&&e.intlMessage||a.helperMissing).call(i,{name:"intlMessage",hash:{intlName:"common.PHOTO_SELECTOR_BACK_TO_ALBUM_LIST"},data:n}))+'</div>\n\t</div>\n\t<div class="title"></div>\n</div>\n\n<div class="photo-selector-photos-wrapper">\n\t<div class="photo-selector-photos">\n\t\t<div class="photo-selector-photos-container">\n\t\t\t<div class="loader"><div class="balls"></div></div>\n\t\t</div>\n\t</div>\n</div>\n\n\n<div class="photo-selector-search-lists-wrapper is-hiding">\n'+(null!=(l=a.if.call(i,null!=(l=null!=e?e.searchable:e)?l.yours:l,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?l:"")+"\n"+(null!=(l=a.if.call(i,null!=(l=null!=e?e.searchable:e)?l.contacts:l,{name:"if",hash:{},fn:t.program(3,n,0),inverse:t.noop,data:n}))?l:"")+"\n"+(null!=(l=a.if.call(i,null!=(l=null!=e?e.searchable:e)?l.everyone:l,{name:"if",hash:{},fn:t.program(5,n,0),inverse:t.noop,data:n}))?l:"")+"\n"+(null!=(l=a.if.call(i,null!=(l=null!=e?e.searchable:e)?l.marketplace:l,{name:"if",hash:{},fn:t.program(7,n,0),inverse:t.noop,data:n}))?l:"")+"</div>\n\n"+(null!=(l=a.if.call(i,null!=e?e.hasUploadCapabilities:e,{name:"if",hash:{},fn:t.program(9,n,0),inverse:t.noop,data:n}))?l:"")+"\n"+(null!=(l=a.if.call(i,null!=e?e.hasGroupCapabilities:e,{name:"if",hash:{},fn:t.program(14,n,0),inverse:t.noop,data:n}))?l:"")},useData:!0}),s={};t.Array.each([],function(e){var a=t.Template.get("hermes/"+e);a&&(s[e]=a)}),t.Template.register("hermes/photo-selector",function(e,n){return n=n||{},n.partials=n.partials?t.merge(s,n.partials):s,a(e,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-infinite-scroll-load-more",function(e,a){var t=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,t,l,n){return'<div class="infinite-scroll-load-more">\n\t<button class="alt">'+e.escapeExpression((t.intlMessage||a&&a.intlMessage||t.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"common.LOAD_MORE_RESULTS"},data:n}))+"</button>\n</div>"},useData:!0}),l={};e.Array.each([],function(a){var t=e.Template.get("hermes/"+a);t&&(l[a]=t)}),e.Template.register("hermes/infinite-scroll-load-more",function(a,n){return n=n||{},n.partials=n.partials?e.merge(l,n.partials):l,t(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-license-detail",function(e,a){var s=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,s,l,t){var n=null!=a?a:{},i=s.helperMissing,r=e.escapeExpression;return'<p class="secondary" style="margin-top: 0;">'+r((s.intlMessage||a&&a.intlMessage||i).call(n,{name:"intlMessage",hash:{intlName:null!=a?a.title:a},data:t}))+'</p>\n<p class="secondary" style="margin-bottom: 0;">'+r((s.intlMessage||a&&a.intlMessage||i).call(n,{name:"intlMessage",hash:{intlName:null!=a?a.body:a},data:t}))+"</p>\n"},useData:!0}),l={};e.Array.each([],function(a){var s=e.Template.get("hermes/"+a);s&&(l[a]=s)}),e.Template.register("hermes/license-detail",function(a,t){return t=t||{},t.partials=t.partials?e.merge(l,t.partials):l,s(a,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});